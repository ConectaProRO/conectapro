<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Contra-Piso - ConectaPro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .cartao {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            padding: 32px;
            margin-bottom: 24px;
        }
        .item-composicao {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }
        .item-composicao:hover {
            background-color: #f9f9f9;
            border-color: #d1d5db;
        }
        .bg-gradient-custom {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        /* Header Suspenso */
        .header-suspenso {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(16, 185, 129, 0.2);
            z-index: 1000;
            padding: 0.75rem 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .nav-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
        }
        .nav-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .nav-btn:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        .nav-btn.secondary {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }
        .nav-btn.secondary:hover {
            background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
            box-shadow: 0 4px 12px rgba(107, 114, 128, 0.3);
        }
        body {
            padding-top: 4rem;
        }
        @media (max-width: 640px) {
            .nav-buttons {
                flex-direction: column;
                gap: 0.5rem;
            }
            .nav-btn {
                width: 100%;
                justify-content: center;
            }
            body {
                padding-top: 6rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header Suspenso -->
    <div class="header-suspenso">
        <div class="nav-buttons">
            <button onclick="voltarCalculadoras()" class="nav-btn">
                üßÆ Voltar √†s Calculadoras
            </button>
            <button onclick="irConectaPro()" class="nav-btn secondary">
                üè† ConectaPro
            </button>
        </div>
    </div>
    
    <div class="min-h-screen py-8">
        <div class="max-w-4xl mx-auto px-4">
            <!-- Cabe√ßalho -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-4">
                    ‚¨ú Calculadora de Contra-Piso
                </h1>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                    Compare pre√ßos entre composi√ß√£o oficial SINAPI e valores de mercado local para execu√ß√£o de contra-piso em argamassa
                </p>
                <div class="bg-green-100 text-green-800 px-4 py-2 rounded-lg mt-4 inline-block">
                    <strong>SINAPI:</strong> Contrapiso em Argamassa Tra√ßo 1:4 (Cimento e Areia) - Espessura 5cm
                </div>
            </div>

            <!-- Sele√ß√£o de Modalidade -->
            <div class="cartao">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    Escolha a Modalidade de Or√ßamento
                </h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div id="btn-sinapi" onclick="selecionarModalidade('sinapi')" 
                         class="p-4 border-2 border-gray-200 rounded-xl transition-all text-center hover:shadow-lg cursor-pointer">
                        <div class="text-3xl mb-3">üèõÔ∏è</div>
                        <h3 class="font-bold text-xl text-blue-600 mb-2">SINAPI Oficial</h3>
                        <p class="text-gray-600 text-sm mb-3">Composi√ß√£o t√©cnica oficial da Caixa Econ√¥mica Federal</p>
                        <div class="text-xs text-gray-500">
                            <div>‚Ä¢ Pedreiro com encargos sociais</div>
                            <div>‚Ä¢ Servente com encargos sociais</div>
                            <div>‚Ä¢ Argamassa tra√ßo 1:4 especificada</div>
                            <div>‚Ä¢ Valores atualizados 05/2025</div>
                        </div>
                    </div>
                    
                    <div id="btn-mercado" onclick="selecionarModalidade('mercado')" 
                         class="p-4 border-2 border-green-500 bg-green-50 rounded-xl transition-all text-center shadow-lg cursor-pointer">
                        <div class="text-3xl mb-3">üè™</div>
                        <h3 class="font-bold text-xl text-green-600 mb-2">Mercado Local</h3>
                        <p class="text-gray-600 text-sm mb-3">Valores praticados por profissionais aut√¥nomos</p>
                        <div class="text-xs text-gray-500">
                            <div>‚Ä¢ Pedreiro aut√¥nomo</div>
                            <div>‚Ä¢ Servente aut√¥nomo</div>
                            <div>‚Ä¢ Materiais em unidades pr√°ticas</div>
                            <div>‚Ä¢ Pre√ßos de mercado real</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Entrada de Dados -->
            <div class="cartao">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    üìè √Årea do Contra-Piso
                </h3>
                
                <div class="max-w-md mx-auto">
                    <div class="mb-6">
                        <label for="area" class="block text-lg font-semibold text-gray-700 mb-2">
                            √Årea Total (m¬≤)
                        </label>
                        <input type="number" 
                               id="area" 
                               placeholder="Ex: 50.0" 
                               step="0.1" 
                               min="1"
                               class="w-full p-4 text-xl border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none transition-colors">
                        <div class="text-sm text-gray-500 mt-2">
                            üí° Informe a √°rea total onde ser√° executado o contra-piso
                        </div>
                    </div>
                    
                    <button onclick="calcularContraPiso()" 
                            class="w-full bg-gradient-custom text-white font-bold py-4 px-6 rounded-lg text-xl hover:opacity-90 transition-opacity">
                        üßÆ Calcular Or√ßamento
                    </button>
                </div>
            </div>

            <!-- Resultado -->
            <div id="resultado" class="hidden">
                <!-- Resultado Principal -->
                <div class="cartao bg-gradient-custom text-white text-center">
                    <h3 class="text-3xl font-bold mb-4">
                        Or√ßamento para <span id="resultado-area">0 m¬≤</span>
                    </h3>
                    <div class="text-6xl font-bold mb-2" id="resultado-valor">
                        R$ 0,00/m¬≤
                    </div>
                    <div class="text-xl opacity-90" id="tipo-orcamento">
                        Modalidade
                    </div>
                </div>

                <!-- Composi√ß√£o Detalhada -->
                <div class="cartao">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                        üîç Composi√ß√£o Detalhada SINAPI
                    </h3>
                    
                    <div class="space-y-6">
                        <!-- M√£o de Obra -->
                        <div>
                            <h4 class="text-xl font-bold text-red-600 mb-4 flex items-center">
                                <span class="mr-2">üë∑</span> M√£o de Obra
                            </h4>
                            <div class="space-y-3">
                                <div class="item-composicao">
                                    <div class="flex-1">
                                        <div class="font-semibold" id="pedreiro-titulo">Pedreiro</div>
                                        <div class="text-sm text-gray-600" id="pedreiro-descricao"></div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-red-600" id="pedreiro-valor"></div>
                                    </div>
                                </div>
                                
                                <div class="item-composicao">
                                    <div class="flex-1">
                                        <div class="font-semibold" id="servente-titulo">Servente</div>
                                        <div class="text-sm text-gray-600" id="servente-descricao"></div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-red-600" id="servente-valor"></div>
                                    </div>
                                </div>
                                
                                <!-- Total M√£o de Obra -->
                                <div class="border-t border-red-300 mt-3 pt-3">
                                    <div class="item-composicao bg-blue-50 border-blue-500">
                                        <div class="flex-1">
                                            <div class="font-bold text-blue-800">TOTAL M√ÉO DE OBRA</div>
                                            <div class="text-sm text-blue-600" id="total-mao-obra-m2">R$ 0,00/m¬≤</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="font-bold text-blue-600 text-xl" id="total-mao-obra"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Materiais -->
                        <div>
                            <h4 class="text-xl font-bold text-red-600 mb-4 flex items-center">
                                <span class="mr-2">üß±</span> Materiais
                            </h4>
                            <div class="space-y-3">
                                <!-- Componentes din√¢micos -->
                                <div id="componentes-dinamicos"></div>
                                
                                <!-- Total Materiais -->
                                <div class="border-t border-red-300 mt-3 pt-3">
                                    <div class="item-composicao bg-green-50 border-green-500">
                                        <div class="flex-1">
                                            <div class="font-bold text-green-800">TOTAL MATERIAIS</div>
                                            <div class="text-sm text-green-600" id="total-materiais-m2">R$ 0,00/m¬≤</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="font-bold text-green-600 text-xl" id="total-materiais"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Total Geral -->
                        <div class="border-t-2 border-red-200 pt-4">
                            <div class="item-composicao bg-red-100 border-red-500">
                                <div class="flex-1">
                                    <div class="font-bold text-lg">TOTAL GERAL</div>
                                    <div class="text-sm text-red-600" id="total-geral-m2">R$ 0,00/m¬≤</div>
                                </div>
                                <div class="text-right">
                                    <div class="font-bold text-red-600 text-2xl" id="total-geral-valor"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>

    <script>
        console.log('‚¨ú Calculadora de Contra-Piso iniciada!');

        // Duas modalidades de or√ßamento baseadas nos dados SINAPI fornecidos
        const modalidades = {
            sinapi: {
                nome: "SINAPI Oficial (Caixa Econ√¥mica)",
                composicao: {
                    pedreiro: { descricao: "Pedreiro com Encargos", valor_hora: 27.80, coeficiente: 0.285 },
                    servente: { descricao: "Servente com Encargos", valor_hora: 23.98, coeficiente: 0.142 },
                    argamassa: { descricao: "Argamassa Tra√ßo 1:4 (Cimento e Areia)", valor_m3: 962.37, coeficiente: 0.0607 }
                }
            },
            mercado: {
                nome: "Mercado Local (Profissionais Aut√¥nomos)",
                composicao: {
                    pedreiro: { descricao: "Pedreiro", valor_hora: 25.00, coeficiente: 0.30 },
                    servente: { descricao: "Servente", valor_hora: 18.00, coeficiente: 0.15 },
                    cimento: { descricao: "Cimento Portland CP II-32", valor_kg: 1.20, coeficiente: 27.62 },
                    areia: { descricao: "Areia M√©dia", valor_m3: 150.00, coeficiente: 0.082 }
                }
            }
        };

        let modalidadeSelecionada = 'mercado';

        function selecionarModalidade(tipo) {
            console.log('Selecionando modalidade:', tipo);
            modalidadeSelecionada = tipo;
            
            // Atualizar visual dos bot√µes
            document.getElementById('btn-sinapi').className = 'p-4 border-2 border-gray-200 rounded-xl transition-all text-center hover:shadow-lg cursor-pointer';
            document.getElementById('btn-mercado').className = 'p-4 border-2 border-gray-200 rounded-xl transition-all text-center hover:shadow-lg cursor-pointer';
            
            if (tipo === 'sinapi') {
                document.getElementById('btn-sinapi').className = 'p-4 border-2 border-green-500 bg-green-50 rounded-xl transition-all text-center shadow-lg cursor-pointer';
            } else {
                document.getElementById('btn-mercado').className = 'p-4 border-2 border-green-500 bg-green-50 rounded-xl transition-all text-center shadow-lg cursor-pointer';
            }
        }

        function calcularContraPiso() {
            console.log('üßÆ Calculando contra-piso...');
            
            const area = parseFloat(document.getElementById('area').value) || 0;
            
            console.log('√Årea:', area);
            
            if (area === 0) {
                alert('‚ö†Ô∏è Por favor, informe a √°rea do contra-piso!');
                return;
            }

            const dados = modalidades[modalidadeSelecionada];
            const comp = dados.composicao;
            
            console.log('Modalidade:', modalidadeSelecionada, dados);
            
            // C√°lculos da m√£o de obra
            const pedreiroHoras = area * comp.pedreiro.coeficiente;
            const serventeHoras = area * comp.servente.coeficiente;
            const pedreiroValor = pedreiroHoras * comp.pedreiro.valor_hora;
            const serventeValor = serventeHoras * comp.servente.valor_hora;
            
            let componentes = [];
            let totalMateriais = 0;
            
            if (modalidadeSelecionada === 'sinapi') {
                // Modalidade SINAPI - usar argamassa pronta
                const argamassaQuantidade = area * comp.argamassa.coeficiente;
                const argamassaValor = argamassaQuantidade * comp.argamassa.valor_m3;
                
                totalMateriais = argamassaValor;
                
                componentes = [
                    { nome: comp.argamassa.descricao, qtd: argamassaQuantidade, unidade: 'm¬≥', valor: argamassaValor, tipo: 'material' }
                ];
            } else {
                // Modalidade mercado local - materiais decompostos
                const cimentoQuantidade = area * comp.cimento.coeficiente;
                const areiaQuantidade = area * comp.areia.coeficiente;
                
                const cimentoValor = cimentoQuantidade * comp.cimento.valor_kg;
                const areiaValor = areiaQuantidade * comp.areia.valor_m3;
                
                totalMateriais = cimentoValor + areiaValor;
                
                // Converter para unidades pr√°ticas de compra
                const cimentoSacos = cimentoQuantidade / 50; // 50kg por saco
                
                componentes = [
                    { nome: comp.cimento.descricao, qtd: cimentoSacos, unidade: 'sacos 50kg', valor: cimentoValor, tipo: 'material' },
                    { nome: comp.areia.descricao, qtd: areiaQuantidade, unidade: 'm¬≥', valor: areiaValor, tipo: 'material' }
                ];
            }
            
            // Calcular totais
            const totalMaoObra = pedreiroValor + serventeValor;
            const totalGeral = totalMaoObra + totalMateriais;
            const valorPorM2 = totalGeral / area;
            
            // Mostrar resultado principal
            document.getElementById('resultado-area').textContent = `${area.toFixed(1)} m¬≤`;
            document.getElementById('resultado-valor').textContent = `R$ ${valorPorM2.toFixed(2)}/m¬≤`;
            document.getElementById('tipo-orcamento').textContent = dados.nome;
            
            // Preencher m√£o de obra
            document.getElementById('pedreiro-titulo').textContent = comp.pedreiro.descricao;
            document.getElementById('pedreiro-descricao').textContent = `${pedreiroHoras.toFixed(2)}h √ó R$ ${comp.pedreiro.valor_hora.toFixed(2)}`;
            document.getElementById('pedreiro-valor').textContent = `R$ ${pedreiroValor.toFixed(2)}`;
            
            document.getElementById('servente-titulo').textContent = comp.servente.descricao;
            document.getElementById('servente-descricao').textContent = `${serventeHoras.toFixed(2)}h √ó R$ ${comp.servente.valor_hora.toFixed(2)}`;
            document.getElementById('servente-valor').textContent = `R$ ${serventeValor.toFixed(2)}`;
            
            // Preencher componentes materiais
            const containerDinamicos = document.getElementById('componentes-dinamicos');
            containerDinamicos.innerHTML = '';
            
            componentes.forEach(comp => {
                const div = document.createElement('div');
                div.className = 'item-composicao';
                
                let descricaoDetalhe = '';
                const qtdTexto = comp.qtd.toFixed(comp.qtd < 1 ? 3 : 2);
                const unidadeTexto = comp.unidade || 'unidades';
                descricaoDetalhe = `${qtdTexto} ${unidadeTexto}`;
                
                div.innerHTML = `
                    <div class="flex-1">
                        <div class="font-semibold">${comp.nome}</div>
                        <div class="text-sm text-gray-600">${descricaoDetalhe}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-red-600">R$ ${comp.valor.toFixed(2)}</div>
                    </div>
                `;
                
                containerDinamicos.appendChild(div);
            });
            
            // Calcular pre√ßos por m¬≤
            const maoObraM2 = totalMaoObra / area;
            const materiaisM2 = totalMateriais / area;
            const totalM2 = totalGeral / area;
            
            // Exibir totais
            document.getElementById('total-mao-obra').innerHTML = 
                `<span class="text-sm text-gray-500">R$</span> ${totalMaoObra.toFixed(2)}`;
            document.getElementById('total-mao-obra-m2').textContent = 
                `R$ ${maoObraM2.toFixed(2)}/m¬≤`;
                
            document.getElementById('total-materiais').innerHTML = 
                `<span class="text-sm text-gray-500">R$</span> ${totalMateriais.toFixed(2)}`;
            document.getElementById('total-materiais-m2').textContent = 
                `R$ ${materiaisM2.toFixed(2)}/m¬≤`;
                
            document.getElementById('total-geral-valor').innerHTML = 
                `<span class="text-sm text-gray-500">R$</span> ${totalGeral.toFixed(2)}`;
            document.getElementById('total-geral-m2').textContent = 
                `R$ ${totalM2.toFixed(2)}/m¬≤`;
            

            
            document.getElementById('resultado').classList.remove('hidden');
            document.getElementById('resultado').scrollIntoView({ behavior: 'smooth' });
            
            console.log('‚úÖ C√°lculo de contra-piso conclu√≠do:', totalGeral);
        }

        // Fun√ß√µes de navega√ß√£o
        function voltarCalculadoras() {
            window.location.href = 'index.html';
        }
        
        function irConectaPro() {
            // Tentar ir para a p√°gina principal do ConectaPro
            if (window.opener) {
                window.opener.location.href = '../src/app/page.tsx';
                window.close();
            } else {
                window.open('../src/app/page.tsx', '_blank');
            }
        }

        // Evento Enter
        document.getElementById('area').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calcularContraPiso();
        });

        console.log('‚¨ú Calculadora de Contra-Piso carregada!');
    </script>
</body>
</html> 